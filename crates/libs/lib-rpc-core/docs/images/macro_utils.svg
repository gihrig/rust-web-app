<svg height="800" width="1000" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><marker id="a" markerHeight="7" markerWidth="10" orient="auto" refX="9" refY="3.5"><path d="m0 0 10 3.5-10 3.5z" fill="#fff"/></marker><path d="m0 0h1000v800h-1000z" fill="#2f2f2f"/><text fill="#fff" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" x="500" y="40">macro_utils.rs - generate_common_rpc_fns! Flow Diagram</text><path d="m50 80h300v180h-300z" fill="none" stroke="#fff" stroke-width="2"/><text fill="#fff" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" x="200" y="105">Macro Input Parameters</text><text fill="#fff" font-family="Arial, sans-serif" font-size="12" x="60" y="130">• Bmc: Business Model Controller</text><text fill="#fff" font-family="Arial, sans-serif" font-size="12" x="60" y="150">• Entity: Return type</text><text fill="#fff" font-family="Arial, sans-serif" font-size="12" x="60" y="170">• ForCreate: Create data type</text><text fill="#fff" font-family="Arial, sans-serif" font-size="12" x="60" y="190">• ForUpdate: Update data type</text><text fill="#fff" font-family="Arial, sans-serif" font-size="12" x="60" y="210">• Filter: List filter type</text><text fill="#fff" font-family="Arial, sans-serif" font-size="12" x="60" y="230">• Suffix: Function name suffix</text><path d="m350 170h70" fill="none" marker-end="url(#a)" stroke="#fff" stroke-width="2"/><path d="m450 80h500v680h-500z" fill="none" stroke="#fff" stroke-width="2"/><text fill="#fff" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" x="700" y="105">Generated RPC Functions</text><path d="m470 120h180v100h-180z" fill="none" stroke="#fff"/><text fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" x="560" y="140">create_{suffix}</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="480" y="160">Input: ParamsForCreate</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="480" y="175">1. Extract data</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="480" y="190">2. Bmc::create()</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="480" y="205">3. Bmc::get() → Entity</text><path d="m670 120h180v100h-180z" fill="none" stroke="#fff"/><text fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" x="760" y="140">get_{suffix}</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="680" y="160">Input: ParamsIded</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="680" y="175">1. Extract id</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="680" y="190">2. Bmc::get() → Entity</text><path d="m470 240h180v100h-180z" fill="none" stroke="#fff"/><text fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" x="560" y="260">list_{suffix}s</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="480" y="280">Input: ParamsList</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="480" y="295">1. Extract filters &amp; options</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="480" y="310">2. Bmc::list() → Vec&lt;Entity&gt;</text><path d="m670 240h180v100h-180z" fill="none" stroke="#fff"/><text fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" x="760" y="260">update_{suffix}</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="680" y="280">Input: ParamsForUpdate</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="680" y="295">1. Extract id &amp; data</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="680" y="310">2. Bmc::update()</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="680" y="325">3. Bmc::get() → Entity</text><path d="m570 360h180v100h-180z" fill="none" stroke="#fff"/><text fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" x="660" y="380">delete_{suffix}</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="580" y="400">Input: ParamsIded</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="580" y="415">1. Extract id</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="580" y="430">2. Bmc::get() → Entity</text><text fill="#fff" font-family="Arial, sans-serif" font-size="10" x="580" y="445">3. Bmc::delete()</text><path d="m470 500h460v120h-460z" fill="none" stroke="#fff"/><text fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" x="700" y="520">Common Function Parameters</text><text fill="#fff" font-family="Arial, sans-serif" font-size="11" x="480" y="545">• ctx: Ctx - Request context</text><text fill="#fff" font-family="Arial, sans-serif" font-size="11" x="480" y="565">• mm: ModelManager - Database connection manager</text><text fill="#fff" font-family="Arial, sans-serif" font-size="11" x="480" y="585">• params: Various param types for different operations</text><text fill="#fff" font-family="Arial, sans-serif" font-size="11" x="480" y="605">Return: Result&lt;DataRpcResult&lt;T&gt;&gt;</text><path d="m470 640h460v100h-460z" fill="none" stroke="#fff"/><text fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" x="700" y="660">Macro Expansion Process</text><text fill="#fff" font-family="Arial, sans-serif" font-size="11" x="480" y="680">1. paste! macro enables identifier concatenation</text><text fill="#fff" font-family="Arial, sans-serif" font-size="11" x="480" y="700">2. Function names generated using [&lt;pattern&gt;] syntax</text><text fill="#fff" font-family="Arial, sans-serif" font-size="11" x="480" y="720">3. Type parameters substituted throughout function bodies</text><path d="m560 220v280" fill="none" stroke="#fff" stroke-dasharray="3 3"/><path d="m760 220v280" fill="none" stroke="#fff" stroke-dasharray="3 3"/><path d="m560 340v160" fill="none" stroke="#fff" stroke-dasharray="3 3"/><path d="m760 340v160" fill="none" stroke="#fff" stroke-dasharray="3 3"/><path d="m660 460v40" fill="none" stroke="#fff" stroke-dasharray="3 3"/><path d="m50 300h300v200h-300z" fill="none" stroke="#fff"/><g fill="#fff" font-family="Arial, sans-serif"><text font-size="14" font-weight="bold" text-anchor="middle" x="200" y="325">CRUD Operations Pattern</text><text font-size="11" x="60" y="350">Create: Insert new entity, return created entity</text><text font-size="11" x="60" y="370">Read: Get single entity by ID</text><text font-size="11" x="60" y="390">List: Get multiple entities with filters</text><text font-size="11" x="60" y="410">Update: Modify entity, return updated entity</text><text font-size="11" x="60" y="430">Delete: Remove entity, return deleted entity</text><text font-size="11" x="60" y="460">Note: All operations go through BMC layer</text><text font-size="11" x="60" y="480">and return consistent DataRpcResult format</text></g></svg>