<svg width="700" height="500" xmlns="http://www.w3.org/2000/svg">
  <rect width="100%" height="100%" fill="#333333"/>
  
  <!-- Token Generation -->
  <rect x="50" y="50" width="275" height="120" stroke="black" stroke-width="2" fill="#444444" rx="5"/>
  <text x="187.5" y="75" font-family="Arial" font-size="16" fill="white" text-anchor="middle">Token Generation</text>
  <text x="187.5" y="100" font-family="Arial" font-size="14" fill="white" text-anchor="middle">1. Get user ID and salt</text>
  <text x="187.5" y="125" font-family="Arial" font-size="14" fill="white" text-anchor="middle">2. Calculate expiration</text>
  <text x="187.5" y="150" font-family="Arial" font-size="14" fill="white" text-anchor="middle">3. Generate signature</text>
  
  <!-- Token Format -->
  <rect x="200" y="200" width="300" height="100" stroke="black" stroke-width="2" fill="#444444" rx="5"/>
  <text x="350" y="225" font-family="Arial" font-size="16" fill="white" text-anchor="middle">Token Format</text>
  <text x="350" y="255" font-family="Arial" font-size="14" fill="white" text-anchor="middle">identifier_b64u.expiration_b64u.signature_b64u</text>
  <text x="350" y="280" font-family="Arial" font-size="14" fill="white" text-anchor="middle">(Base64URL-encoded components)</text>
  
  <!-- Token Validation -->
  <rect x="375" y="50" width="275" height="120" stroke="black" stroke-width="2" fill="#444444" rx="5"/>
  <text x="512.5" y="75" font-family="Arial" font-size="16" fill="white" text-anchor="middle">Token Validation</text>
  <text x="512.5" y="100" font-family="Arial" font-size="14" fill="white" text-anchor="middle">1. Parse token</text>
  <text x="512.5" y="125" font-family="Arial" font-size="14" fill="white" text-anchor="middle">2. Validate signature</text>
  <text x="512.5" y="150" font-family="Arial" font-size="14" fill="white" text-anchor="middle">3. Check expiration</text>
  
  <!-- Cryptographic Operations -->
  <rect x="50" y="330" width="600" height="120" stroke="black" stroke-width="2" fill="#444444" rx="5"/>
  <text x="350" y="355" font-family="Arial" font-size="16" fill="white" text-anchor="middle">Cryptographic Operations</text>
  <text x="350" y="380" font-family="Arial" font-size="14" fill="white" text-anchor="middle">Blake3 Hashing Algorithm</text>
  <text x="350" y="405" font-family="Arial" font-size="14" fill="white" text-anchor="middle">Inputs: identifier, expiration, salt, secret key</text>
  <text x="350" y="430" font-family="Arial" font-size="14" fill="white" text-anchor="middle">Output: Base64URL-encoded signature</text>
  
  <!-- Arrows -->
  <line x1="187.5" y1="170" x2="275" y2="200" stroke="white" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="512.5" y1="170" x2="425" y2="200" stroke="white" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <line x1="350" y1="300" x2="350" y2="330" stroke="white" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <line x1="120" y1="170" x2="120" y2="330" stroke="white" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="580" y1="170" x2="580" y2="330" stroke="white" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Arrow definitions -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="white"/>
    </marker>
  </defs>
</svg>
